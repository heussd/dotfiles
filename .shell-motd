# Console prints may be skipped
if [ "$PWD" = "$HOME" ]; then

	echo
	_hasCmd figlet && (
		figlet '  ' $SHORTHOSTNAME
	) || echo '  ' $SHORTHOSTNAME
	echo
	
	_isLinux && (
		lsb_release --short --description
	) || echo $(sw_vers -productName) $(sw_vers -productVersion) $(sw_vers -buildVersion)
	
	echo "dotfiles @ $(dotfiles log --oneline | head -n 1)"
	echo -e "\033[31m$(dotfiles status --porcelain)\033[0m"
	echo -e "\033[31m$(dotfiles-private status --porcelain)\033[0m"

	_hasCmd zpool && (
		zpool status && echo
	)

	_hasCmd docker && (
		docker ps --format "table {{.Image}}\t{{.Status}}\t{{.Ports}}" 2> /dev/null | tail -n +2 && echo
	)
		
	# Updates on macOS might require reinstallation of developer tools
	_hasCmd make || (
		_isMacOS && xcode-select --install
	)

	KITTY=$(echo $TERMINFO | grep kitty > /dev/null && echo "YES")
	make KITTY=$KITTY
fi

# Try to resume screen session
_hasCmd screen && (
	if [ $TERM != 'screen' ]; then
	  screen -r > /dev/null
	fi
)


# motd: hostname version
